---
title: "ãƒãƒƒãƒˆã‚¹ãƒ¼ãƒ‘ãƒ¼ã®é…é”äºˆå®šæ—¥æ™‚ã‚’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«è‡ªå‹•ç™»éŒ²ã™ã‚‹"
emoji: "ğŸ”–"
type: "idea"
topics: ["GoogleCalendar","GoogleAppsScript","gmail"]
published: true
---
# ã¯ã˜ã‚ã«

é‡ã„ã‚‚ã®ï¼ˆãŠç±³ã‚„ãŠæ°´ãªã©ï¼‰ã‚’è²·ã†éš›ã¯ãƒãƒƒãƒˆã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚
ãã¡ã‚“ã¨å—ã‘å–ã‚‹ãŸã‚ã«ã¯ã€ãã®é…é”äºˆå®šæ™‚é–“ã«å¤–å‡ºã—ãªã„ã‚ˆã†ã«æ°—ã‚’ã¤ã‘ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚

ãã“ã§ã€æ³¨æ–‡æ™‚ã«é€ä¿¡ã•ã‚Œã‚‹ãƒ¡ãƒ¼ãƒ«ã‚’è§£æã—ã¦é…é”äºˆå®šæ—¥æ™‚ã‚’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«ç™»éŒ²ã™ã‚‹ã‚ˆã†ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚

# ã‚¤ãƒ¡ãƒ¼ã‚¸
![](https://qiita-image-store.s3.amazonaws.com/0/104653/edc04e4a-e7f8-5401-c911-9b036fd327a8.png)

# å‡¦ç†
GoogleAppsScriptã§ä½œæˆã—ã¾ã—ãŸã€‚

- ãƒˆãƒªã‚¬ãƒ¼: 5åˆ†ã”ã¨

```javascript
function main() {
  
  var predicate = function(thread) {
    return thread.getFirstMessageSubject() == "[ã”æ³¨æ–‡ç¢ºèª]SEIYUãƒ‰ãƒƒãƒˆã‚³ãƒ ";
  }
  var regex = new RegExp(/ãƒ»ãŠå±Šã‘æ—¥æ™‚ï¼š([0-9]+\/[0-9]+\/[0-9]+) ([0-9]+)æ™‚([0-9]+)åˆ†ï½([0-9]+)æ™‚([0-9]+)åˆ†/);

  // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’å–å¾—
  var calendar = CalendarApp.getCalendarById('...@gmail.com');
  
  // ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’å–å¾—
  var threads = GmailApp.getInboxThreads().filter(predicate);
  threads.forEach(function(thread) {
    // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—
    var messages = thread.getMessages();
    messages.forEach(function(message) {
      // æœ¬æ–‡ã‚’å–å¾—
      var body = message.getPlainBody();
      
      // ãŠå±Šã‘æ—¥æ™‚ã‚’å–å¾—
      var match = body.match(regex);
      var date = match[1];
      var fromHour = match[2];
      var fromMinute = match[3];
      var toHour = match[4];
      var toMinute = match[5];
      
      // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«äºˆå®šè¿½åŠ 
      calendar.createEvent("[SEIYU]ãƒãƒƒãƒˆã‚¹ãƒ¼ãƒ‘ãƒ¼",
                           new Date(date + " " + fromHour + ":" + fromMinute + ":00"),
                           new Date(date + " " + toHour + ":" + toMinute + ":00"));
      
      // ãƒ¡ãƒ¼ãƒ«ã‚’æ—¢èª­ã«ã™ã‚‹
      message.markRead();
    });
    // ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
    thread.moveToArchive();
  });
}
```

# å‹•ä½œç¢ºèª

Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ç¢ºèªã—ã¾ã™ã€‚
![](https://qiita-image-store.s3.amazonaws.com/0/104653/301fe6ee-3725-1627-a975-ef69dae02d4c.png)

Gmailã®å—ä¿¡BOXã‚‚ç¢ºèªã—ã€å‡¦ç†ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚

# æ„Ÿæƒ³

é€šè²©ã‚µãƒ¼ãƒ“ã‚¹ã¯ã»ã¼å¿…ãšæ³¨æ–‡ç¢ºèªãƒ¡ãƒ¼ãƒ«ã‚’é€ã£ã¦ãã‚Œã‚‹ã®ã§ã€å¿œç”¨ã™ã‚Œã°ä»–é€šè²©ã§ã‚‚å‡ºæ¥ãã†ã§ã™ã€‚
